using System;
using System.Net.Security;
using System.Security.Cryptography.X509Certificates;
using UnityEngine;

namespace Classes
{
    class CertificadoOGS : MonoBehaviour
    {
        //IFB
        private static string PUB_KEY = "3082020A0282020100AA922AFEF057BF2D23FBC44240647C28402DBC6851BA5A25D78CF656A874578E8757ACCECA1AA15C01878A248E873999813DB826740D3EAA379DEBEBFBBC151F117EBD5B7D9FE3AAD614128ECCCE1F36FFC70C93B776CB4112E2C5CC3B033027F4FFDA6D688E7E21747FB0A5AE1D831FC3C7D6D4C08E0E783AFA5EC8D54A8B36573AFB4B8F48A8C84722D7EAF14C5A37A7E40AAFFAA9F6CBF1EF14228F730D89B27BBE72B5176AF6E2494E38F5BA517C8FC4A5549C39B7F085AF66269A51139F4B381C7BCBEB2256A6BD9F6B523385CC646560EA14793EEC2A6E32ACB602A8A491C8D7EE5F8063C936B9E8BFB0045D513E6F71317C9B0D9C9D4D346138853264422207F5DEEEF50C12DBED1F0C63E0EA2397D85ED67A3A1DAE81600E7437D38CC7FF3507460B169DE9F617D539BD40C1924F5949A27219343466BE73FBD083895A70F554180CDEED3B1B374D1CA3BEFBCE9DC46574BC4652877964D346568A72001C2E50A9CAFF02692080BFA5D1CC806BCF7657CCC207EC0AE42D66E5A0D851F670C4D50E121025DBA4915EEBF825D2702887D523C1316D48E266B66C28D19A6FBDC407360847D8D2F057C2B4FC79C0166DD3CD8712D5708FABEAC6DB3DC5589848CD7316384FE8187882587CD02D86143728E3BA57EB4D0926A896BBA148161B2F2EAFCEF5761B684ACCFCC29D17E99C9188C1F905D341AF17F1F0C912B8BF0203010001";
        //LOCAL
        //private static string PUB_KEY = "3082010A0282010100D19A4CA1CC611FFBBE5EB1AAF54406674C0021B671239E60DD9A7F408D6AA9143981C113F9E6834F7C65DB7697BB867C6FBA90D9F1396B0530446377A3DAADC4A8F821AA5E65203842F54371C0F98DE70E9343F73BA45853529BB778AEFE8DE955BED98CEA627EB65F1BDF9D12D2588E3D0269A92908D009284148FE0137D213361B22004F5B7FE0568DB04D4FCF26C2853EB5514D8221574A0AE75E8525F83225F05E14AB57D6D0199509A5FD84A5D286278D667C54CE74EE10B201C63CB63E947A322997D9015BFACAEE8D49BD7E9176017CBE710F8AFE22E27A620CA63B28A3F9518AC6AEC0EAE370B824E08394A9A58E9A58551766DCA51B62716540EEB10203010001";
        
        public static bool validador(System.Object sender, X509Certificate certificado, X509Chain x509Chain, SslPolicyErrors v)
        {
            
            if (!certificado.GetPublicKeyString().Equals(PUB_KEY))
            {
                Debug.Log(certificado.GetPublicKeyString());
                return false;
            }

            if (DateTime.Parse(certificado.GetExpirationDateString()) < DateTime.Now)
            {
                return false;
            }

            return true;

        }

    }
}
