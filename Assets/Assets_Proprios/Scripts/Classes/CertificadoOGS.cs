using System;
using System.Net.Security;
using System.Security.Cryptography.X509Certificates;
using UnityEngine;

namespace Classes
{
    class CertificadoOGS : MonoBehaviour
    {
        //IFB
        //private static string PUB_KEY = "3082010A0282010100A43905AA2FF965889F81F246EB147D935477F67021710586E663A1C3F13D46BD388DF0AAC27B27F88F4375A4056347AB0D13C21B519D8DE311F498C0FA8FFCFE558BAB72B0DE9EEFBBD9DA173995EBBCC1196F562168CCD24B1AA3F077EEE0E84F400C683E083B414E71DCC4681E738124C3706D60B606B8F4F0FD07E959B2F5482DAE5D95D4E6E04CDA627E683C7B21BCFE5D580848329AEB70B39B52CDBD350B30EAC2EEE9F52BE36FC389C0C9E9ACAEA5FF1E3A72B2E9C1E8BEC325FECC3D43AF89C1A1376A867A13DA2DF6A566E9B74A98E79BBE40A128455D0957308159B6C653D6DF12D058A9DAE2D2397DB2416448198F4522EE8C84498CB9D32328F90203010001";
        //LOCAL
        private static string PUB_KEY = "3082010A0282010100D19A4CA1CC611FFBBE5EB1AAF54406674C0021B671239E60DD9A7F408D6AA9143981C113F9E6834F7C65DB7697BB867C6FBA90D9F1396B0530446377A3DAADC4A8F821AA5E65203842F54371C0F98DE70E9343F73BA45853529BB778AEFE8DE955BED98CEA627EB65F1BDF9D12D2588E3D0269A92908D009284148FE0137D213361B22004F5B7FE0568DB04D4FCF26C2853EB5514D8221574A0AE75E8525F83225F05E14AB57D6D0199509A5FD84A5D286278D667C54CE74EE10B201C63CB63E947A322997D9015BFACAEE8D49BD7E9176017CBE710F8AFE22E27A620CA63B28A3F9518AC6AEC0EAE370B824E08394A9A58E9A58551766DCA51B62716540EEB10203010001";
        
        public static bool validador(System.Object sender, X509Certificate certificado, X509Chain x509Chain, SslPolicyErrors v)
        {
            
            if (!certificado.GetPublicKeyString().Equals(PUB_KEY))
            {
                Debug.Log(certificado.GetPublicKeyString());
                return false;
            }

            if (DateTime.Parse(certificado.GetExpirationDateString()) < DateTime.Now)
            {
                return false;
            }

            return true;

        }

    }
}
